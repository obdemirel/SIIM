# SIIM
Signal intensity informed multi-coil encoding operator for physics-guided deep learning reconstruction

This is an implementation of "Signal intensity informed multi-coil encoding operator for physics-guided deep learning reconstruction of highly accelerated myocardial perfusion CMR"

© 2021 Regents of the University of Minnesota

SIIM is copyrighted by Regents of the University of Minnesota. Regents of the University of Minnesota will license the use of SIIM solely for educational and research purposes by non-profit institutions and US government agencies only. For other proposed uses, contact umotc@umn.edu. The software may not be sold or redistributed without prior approval. One may make copies of the software for their use provided that the copies, are not sold or distributed, are used under the same terms and conditions. As unestablished research software, this code is provided on an "as is'' basis without warranty of any kind, either expressed or implied. The downloading, or executing any part of this software constitutes an implicit agreement to these terms. These terms and conditions are subject to change at any time without prior notice.

Please cite the following:

Demirel OB, Yaman B,Shenoy C, Moeller S, Weingärtner S, Akçakaya M.Signal intensity informed multi-coil encodingoperator for physics-guided deep learningreconstruction of highly accelerated myocardialperfusion CMR.Magn Reson Med. 2022;1-14. 
https://doi:10.1002/mrm.29453

This implementation consist of two parts. Signal intensity information of the SMS accelerated images are generated by first running split slice-GRAPPA. The MATLAB function "pre_precossing.m" handles the singal intensity information for each slice and each time frame along with the saving format for the physics-guided deep learning reconstruction part. To train, please use training.py and to test please use testing.py. The model that has been used in the paper can be found under savedModels folder. 

Here is the data structure:
RO:          # of readout lines,
PE:          # of phase encode lines,
No_C:        # of coil elements,
Slices:      # of slices,
Time-frames: # of time-frames phases,

Input data:
- kspace (RO x PE x NO_C x Dynamics)
- acs (RO x PE x NO_C x Sices) with CAIPI shifts
- sense_maps (RO x PE x NO_C x Dynamics) with CAIPI shifts


Output data - Resuls (compared to split-slice-GRAPPA)

![Output](assets/output.png)

Readout concatenation is used to generate extended k-space and calibration region.
- Input: acquired k-space, acs (CAIPIRINHA shifted)
- Output: extended k-space, ROCK-SPIRiT kernels, kernel sizes



ROCK-SPIRiT
- Input: extended k-space, sensitivity maps, ROCK-SPIRiT kernels, kernel sizes,
         slice acceleration, #of CG iterations
- Output: reconstructed extended-kspace, reconstructed SENSE-1 Images
         
Regularized ROCK-SPIRiT
- Input: extended k-space, sensitivity maps, ROCK-SPIRiT kernels, kernel sizes,
         slice acceleration, #of CG iterations, # of ADMM loops
- Output: reconstructed extended-kspace, reconstructed SENSE-1 Images

Regularization:
- Locally low rank (LLR) regularization is supported via ADMM in regularized ROCK-SPIRiT
- To avoid border artifacts, CAIPIRINHA shifts are re-shifted/shifted before/after the regularization

